{"version":3,"file":"paywall-editor.element-BPlG-FEH.js","sources":["../../../Client/src/property-editors/paywall-editor.element.ts"],"sourcesContent":["import { LitElement, html, css } from '@umbraco-cms/backoffice/external/lit';\r\nimport { customElement, property, state } from '@umbraco-cms/backoffice/external/lit';\r\n\r\n// A lightweight property editor UI for configuring the breezPaywall JSON string\r\n// Stored value: JSON string with shape { enabled: boolean, fee: number }\r\n@customElement('tollervey-paywall-editor')\r\nexport class TollerveyPaywallEditorElement extends LitElement {\r\n // The current value from Umbraco. We accept string (JSON) or object for robustness.\r\n @property({ type: Object }) modelValue: any = '';\r\n\r\n @state() private _enabled = false;\r\n @state() private _fee: number =0;\r\n @state() private _error = '';\r\n\r\n connectedCallback(): void {\r\n super.connectedCallback();\r\n this._fromModelValue(this.modelValue);\r\n }\r\n\r\n updated(changed: Map<string, unknown>) {\r\n if (changed.has('modelValue')) {\r\n this._fromModelValue(this.modelValue);\r\n }\r\n }\r\n\r\n private _fromModelValue(value: any) {\r\n try {\r\n let obj: any = value;\r\n if (typeof value === 'string' && value.trim() !== '') {\r\n try { obj = JSON.parse(value); } catch { /* ignore parse errors */ }\r\n }\r\n this._enabled = !!obj?.enabled;\r\n const fee = Number(obj?.fee ??0);\r\n this._fee = Number.isFinite(fee) && fee >=0 ? fee :0;\r\n this._error = '';\r\n } catch (e: any) {\r\n this._enabled = false;\r\n this._fee =0;\r\n this._error = 'Invalid value';\r\n }\r\n }\r\n\r\n private _emitChange() {\r\n const json = JSON.stringify({ enabled: this._enabled, fee: this._fee });\r\n this.dispatchEvent(new CustomEvent('umbPropertyValueChange', { detail: { value: json } }));\r\n }\r\n\r\n render() {\r\n return html`\r\n <div class=\"editor\">\r\n <uui-form-layout-item>\r\n <uui-toggle\r\n .checked=${this._enabled}\r\n @change=${(e: any) => { this._enabled = !!e.target.checked; this._emitChange(); }}\r\n label=\"Enable paywall\"\r\n ></uui-toggle>\r\n </uui-form-layout-item>\r\n\r\n <uui-form-layout-item>\r\n <uui-label for=\"fee\">Fee (sats)</uui-label>\r\n <uui-input\r\n id=\"fee\"\r\n type=\"number\"\r\n min=\"0\"\r\n step=\"1\"\r\n .value=${String(this._fee)}\r\n @input=${(e: any) => { const v = parseInt(e.target.value || '0',10); this._fee = Number.isFinite(v) && v >=0 ? v :0; this._emitChange(); }}\r\n ></uui-input>\r\n <uui-helper>Amount the user must pay to unlock the content.</uui-helper>\r\n </uui-form-layout-item>\r\n\r\n ${this._error ? html`<uui-alert color=\"danger\">${this._error}</uui-alert>` : ''}\r\n </div>\r\n `;\r\n }\r\n\r\n static styles = [\r\n css`\r\n :host { display: block; }\r\n .editor { display: grid; gap: var(--uui-size-space-4); }\r\n `,\r\n ];\r\n}\r\n\r\ndeclare global {\r\n interface HTMLElementTagNameMap {\r\n 'tollervey-paywall-editor': TollerveyPaywallEditorElement;\r\n }\r\n}\r\n"],"names":["TollerveyPaywallEditorElement","LitElement","changed","value","obj","fee","json","html","v","css","__decorateClass","property","state","customElement"],"mappings":";;;;;;AAMO,IAAMA,IAAN,cAA4CC,EAAW;AAAA,EAAvD,cAAA;AAAA,UAAA,GAAA,SAAA,GAEsB,KAAA,aAAkB,IAErC,KAAQ,WAAW,IACnB,KAAQ,OAAc,GACtB,KAAQ,SAAS;AAAA,EAAA;AAAA,EAE1B,oBAA0B;AAC1B,UAAM,kBAAA,GACN,KAAK,gBAAgB,KAAK,UAAU;AAAA,EACpC;AAAA,EAEA,QAAQC,GAA+B;AACvC,IAAIA,EAAQ,IAAI,YAAY,KAC5B,KAAK,gBAAgB,KAAK,UAAU;AAAA,EAEpC;AAAA,EAEQ,gBAAgBC,GAAY;AACpC,QAAI;AACJ,UAAIC,IAAWD;AACf,UAAI,OAAOA,KAAU,YAAYA,EAAM,KAAA,MAAW;AAClD,YAAI;AAAE,UAAAC,IAAM,KAAK,MAAMD,CAAK;AAAA,QAAG,QAAQ;AAAA,QAA4B;AAEnE,WAAK,WAAW,CAAC,CAACC,GAAK;AACvB,YAAMC,IAAM,OAAOD,GAAK,OAAM,CAAC;AAC/B,WAAK,OAAO,OAAO,SAASC,CAAG,KAAKA,KAAM,IAAIA,IAAK,GACnD,KAAK,SAAS;AAAA,IACd,QAAiB;AACjB,WAAK,WAAW,IAChB,KAAK,OAAM,GACX,KAAK,SAAS;AAAA,IACd;AAAA,EACA;AAAA,EAEQ,cAAc;AACtB,UAAMC,IAAO,KAAK,UAAU,EAAE,SAAS,KAAK,UAAU,KAAK,KAAK,MAAM;AACtE,SAAK,cAAc,IAAI,YAAY,0BAA0B,EAAE,QAAQ,EAAE,OAAOA,EAAA,EAAK,CAAG,CAAC;AAAA,EACzF;AAAA,EAEA,SAAS;AACT,WAAOC;AAAA;AAAA;AAAA;AAAA,YAII,KAAK,QAAQ;AAAA,WACd,CAAC,MAAW;AAAE,WAAK,WAAW,CAAC,CAAC,EAAE,OAAO,SAAS,KAAK,YAAA;AAAA,IAAe,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAYxE,OAAO,KAAK,IAAI,CAAC;AAAA,UACjB,CAAC,MAAW;AAAE,YAAMC,IAAI,SAAS,EAAE,OAAO,SAAS,KAAI,EAAE;AAAG,WAAK,OAAO,OAAO,SAASA,CAAC,KAAKA,KAAI,IAAIA,IAAG,GAAG,KAAK,YAAA;AAAA,IAAe,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,GAKxI,KAAK,SAASD,8BAAiC,KAAK,MAAM,iBAAiB,EAAE;AAAA;AAAA;AAAA,EAG/E;AAQD;AA5EaP,EAsEL,SAAS;AAAA,EAChBS;AAAA;AAAA;AAAA;AAIA;AAzE4BC,EAAA;AAAA,EAA3BC,EAAS,EAAE,MAAM,OAAA,CAAQ;AAAA,GAFdX,EAEgB,WAAA,cAAA,CAAA;AAEXU,EAAA;AAAA,EAAhBE,EAAA;AAAM,GAJKZ,EAIK,WAAA,YAAA,CAAA;AACAU,EAAA;AAAA,EAAhBE,EAAA;AAAM,GALKZ,EAKK,WAAA,QAAA,CAAA;AACAU,EAAA;AAAA,EAAhBE,EAAA;AAAM,GANKZ,EAMK,WAAA,UAAA,CAAA;AANLA,IAANU,EAAA;AAAA,EADNG,EAAc,0BAA0B;AAAA,GAC5Bb,CAAA;"}
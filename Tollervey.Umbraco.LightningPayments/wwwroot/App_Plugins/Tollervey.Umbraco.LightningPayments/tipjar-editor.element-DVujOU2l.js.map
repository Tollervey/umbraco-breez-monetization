{"version":3,"file":"tipjar-editor.element-DVujOU2l.js","sources":["../../../Client/src/property-editors/tipjar-editor.element.ts"],"sourcesContent":["import { LitElement, html, css } from '@umbraco-cms/backoffice/external/lit';\r\nimport { customElement, property, state } from '@umbraco-cms/backoffice/external/lit';\r\n\r\n@customElement('tollervey-tipjar-editor')\r\nexport class TollerveyTipJarEditorElement extends LitElement {\r\n @property({ type: Object }) modelValue: any = '';\r\n @state() private _enabled = false;\r\n @state() private _label = 'Send a tip';\r\n @state() private _defaultAmounts: number[] = [500,1000,2500];\r\n\r\n connectedCallback(): void {\r\n super.connectedCallback();\r\n this._fromModelValue(this.modelValue);\r\n }\r\n\r\n updated(changed: Map<string, unknown>) {\r\n if (changed.has('modelValue')) {\r\n this._fromModelValue(this.modelValue);\r\n }\r\n }\r\n\r\n private _fromModelValue(value: any) {\r\n try {\r\n let obj: any = value;\r\n if (typeof value === 'string' && value.trim() !== '') {\r\n try { obj = JSON.parse(value); } catch { /* ignore parse errors */ }\r\n }\r\n this._enabled = !!obj?.enabled;\r\n this._label = typeof obj?.label === 'string' && obj.label.trim() ? obj.label : 'Send a tip';\r\n const arr = Array.isArray(obj?.defaultAmounts) ? obj.defaultAmounts.map((x: any) => parseInt(String(x),10)).filter((n: number) => Number.isFinite(n) && n >0) : [];\r\n this._defaultAmounts = arr.length ? arr : [500,1000,2500];\r\n } catch {\r\n this._enabled = false;\r\n this._label = 'Send a tip';\r\n this._defaultAmounts = [500,1000,2500];\r\n }\r\n }\r\n\r\n private _emitChange() {\r\n const json = JSON.stringify({ enabled: this._enabled, label: this._label, defaultAmounts: this._defaultAmounts });\r\n this.dispatchEvent(new CustomEvent('umbPropertyValueChange', { detail: { value: json } }));\r\n }\r\n\r\n private _onAddAmount() {\r\n const val = prompt('Add amount (sats):', '1000');\r\n if (!val) return;\r\n const n = parseInt(val,10);\r\n if (!Number.isFinite(n) || n <=0) return;\r\n this._defaultAmounts = [...this._defaultAmounts, n];\r\n this._emitChange();\r\n }\r\n\r\n private _onRemoveAmount(idx: number) {\r\n this._defaultAmounts = this._defaultAmounts.filter((_, i) => i !== idx);\r\n this._emitChange();\r\n }\r\n\r\n render() {\r\n return html`\r\n <div class=\"editor\">\r\n <uui-form-layout-item>\r\n <uui-toggle\r\n .checked=${this._enabled}\r\n @change=${(e: any) => { this._enabled = !!e.target.checked; this._emitChange(); }}\r\n label=\"Enable tip jar\"\r\n ></uui-toggle>\r\n </uui-form-layout-item>\r\n\r\n <uui-form-layout-item>\r\n <uui-label for=\"label\">Label</uui-label>\r\n <uui-input id=\"label\" type=\"text\" .value=${this._label} @input=${(e: any) => { this._label = e.target.value; this._emitChange(); }}></uui-input>\r\n <uui-helper>Shown next to the tip button.</uui-helper>\r\n </uui-form-layout-item>\r\n\r\n <uui-form-layout-item>\r\n <uui-label>Default amounts (sats)</uui-label>\r\n <div class=\"chips\">\r\n ${this._defaultAmounts.map((amt, idx) => html`<span class=\"chip\">${amt}<button class=\"x\" @click=${() => this._onRemoveAmount(idx)} aria-label=\"Remove\">ï¿½</button></span>`) }\r\n <uui-button look=\"secondary\" @click=${this._onAddAmount}>Add</uui-button>\r\n </div>\r\n <uui-helper>Users can still enter a custom amount in the website component.</uui-helper>\r\n </uui-form-layout-item>\r\n </div>\r\n `;\r\n }\r\n\r\n static styles = [\r\n css`\r\n :host { display:block; }\r\n .editor { display:grid; gap: var(--uui-size-space-4); }\r\n .chips { display:flex; flex-wrap: wrap; gap:0.35rem; align-items: center; }\r\n .chip { padding:0.25rem0.5rem; border:1px solid #ddd; border-radius:999px; display:inline-flex; gap:0.35rem; align-items:center; }\r\n .x { appearance:none; border:0; background: none; cursor: pointer; font-size:1rem; line-height:1; }\r\n `,\r\n ];\r\n}\r\n\r\ndeclare global {\r\n interface HTMLElementTagNameMap { 'tollervey-tipjar-editor': TollerveyTipJarEditorElement; }\r\n}\r\n"],"names":["TollerveyTipJarEditorElement","LitElement","changed","value","obj","arr","x","n","json","val","idx","_","html","amt","css","__decorateClass","property","state","customElement"],"mappings":"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"}